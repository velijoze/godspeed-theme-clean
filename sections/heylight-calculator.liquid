<!-- /sections/heylight-calculator.liquid -->
{% comment %}
  Heylight Financing Calculator Section - Add this to any page using the page builder
{% endcomment %}

<div class="heylight-calculator">
  <div class="calculator-container">
    <div class="calculator-header">
      <h2>{{ section.settings.title | default: "Calculate Your Monthly Payment" }}</h2>
      <p>{{ section.settings.subtitle | default: "Use our calculator to see exactly what you'll pay each month with Heylight financing" }}</p>
    </div>
    
    <div class="calculator-form-container">
      <!-- Calculator Form -->
      <div class="calculator-form">
        <div class="form-row">
          <div class="form-group">
            <label for="bike-price-{{ section.id }}">E-Bike Price (CHF)</label>
            <input type="number" id="bike-price-{{ section.id }}" name="bike-price" placeholder="2499" min="500" max="10000" value="2499">
          </div>
          
          <div class="form-group">
            <label for="down-payment-{{ section.id }}">Down Payment (CHF)</label>
            <input type="number" id="down-payment-{{ section.id }}" name="down-payment" placeholder="500" min="0" max="5000" value="500">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="loan-term-{{ section.id }}">Loan Term</label>
            <select id="loan-term-{{ section.id }}" name="loan-term">
              <option value="12">12 months</option>
              <option value="24" selected>24 months</option>
              <option value="36">36 months</option>
              <option value="48">48 months</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="credit-score-{{ section.id }}">Credit Score Range</label>
            <select id="credit-score-{{ section.id }}" name="credit-score">
              <option value="excellent">Excellent (750+)</option>
              <option value="good" selected>Good (700-749)</option>
              <option value="fair">Fair (650-699)</option>
              <option value="poor">Poor (600-649)</option>
            </select>
          </div>
        </div>
        
        <button type="button" class="btn btn--heylight btn--large" onclick="calculateHeylightFinancing('{{ section.id }}')">
          {{ section.settings.calculate_button_text | default: "Calculate with Heylight" }}
        </button>
      </div>
      
      <!-- Results -->
      <div id="financing-results-{{ section.id }}" class="financing-results" style="display: none;">
        <div class="heylight-results-header">
          <div class="heylight-logo-small">
            <span>ðŸ’š</span>
          </div>
          <h4>{{ section.settings.results_title | default: "Your Heylight Financing Summary" }}</h4>
        </div>
        
        <div class="results-grid">
          <div class="result-card heylight-card">
            <div class="result-label">Loan Amount</div>
            <div class="result-value" id="loan-amount-{{ section.id }}">CHF 1,999</div>
          </div>
          
          <div class="result-card heylight-card">
            <div class="result-label">Monthly Payment</div>
            <div class="result-value" id="monthly-payment-{{ section.id }}">CHF 83.29</div>
          </div>
          
          <div class="result-card heylight-card">
            <div class="result-label">Interest Rate</div>
            <div class="result-value" id="interest-rate-{{ section.id }}">0%</div>
          </div>
          
          <div class="result-card heylight-card">
            <div class="result-label">Total Cost</div>
            <div class="result-value" id="total-cost-{{ section.id }}">CHF 1,999</div>
          </div>
        </div>
        
        <div class="heylight-advantage">
          <div class="advantage-icon">ðŸŽ‰</div>
          <div class="advantage-text">
            <h5>{{ section.settings.advantage_title | default: "You Save CHF 0 in Interest!" }}</h5>
            <p>{{ section.settings.advantage_text | default: "With Heylight's 0% financing, you pay exactly the bike price - no more, no less." }}</p>
          </div>
        </div>
      </div>
      
      <!-- Action Buttons -->
      <div class="calculator-actions">
        <button class="btn btn--secondary" onclick="resetCalculator('{{ section.id }}')">
          {{ section.settings.reset_button_text | default: "Reset" }}
        </button>
        <button class="btn btn--heylight" onclick="applyHeylightFinancing('{{ section.id }}')">
          {{ section.settings.apply_button_text | default: "Apply with Heylight" }}
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  .heylight-calculator {
    margin: 4rem 0;
  }
  
  .calculator-container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 2rem;
  }
  
  .calculator-header {
    text-align: center;
    margin-bottom: 3rem;
  }
  
  .calculator-header h2 {
    font-size: 2rem;
    color: #2c2c2c;
    margin-bottom: 1rem;
  }
  
  .calculator-header p {
    color: #666;
    font-size: 1.1rem;
  }
  
  .calculator-form-container {
    background: #ffffff;
    border-radius: 20px;
    padding: 3rem;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    border: 2px solid #f0f0f0;
  }
  
  .calculator-form {
    max-width: 800px;
    margin: 0 auto 2rem auto;
  }
  
  .form-row {
    display: flex;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }
  
  .form-group {
    flex: 1;
  }
  
  .form-group label {
    display: block;
    font-weight: 600;
    color: #2c2c2c;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
  }
  
  .form-group input,
  .form-group select {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
    background: #ffffff;
  }
  
  .form-group input:focus,
  .form-group select:focus {
    outline: none;
    border-color: #00D4AA;
    box-shadow: 0 0 0 3px rgba(0,212,170,0.1);
  }
  
  .btn--heylight {
    background: #00D4AA;
    color: #ffffff;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .btn--heylight:hover {
    background: #00B894;
    transform: translateY(-1px);
  }
  
  .btn--large {
    width: 100%;
    padding: 1rem;
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 1rem;
  }
  
  .financing-results {
    margin-top: 2rem;
    padding: 2rem;
    background: #f8f9fa;
    border-radius: 16px;
    border: 2px solid #e0e0e0;
  }
  
  .heylight-results-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    justify-content: center;
  }
  
  .heylight-logo-small {
    font-size: 2rem;
  }
  
  .financing-results h4 {
    color: #2c2c2c;
    margin: 0;
    font-size: 1.5rem;
  }
  
  .results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
  }
  
  .result-card {
    background: #ffffff;
    padding: 1.5rem;
    border-radius: 12px;
    text-align: center;
    border: 1px solid #e0e0e0;
  }
  
  .heylight-card {
    border-color: #00D4AA;
    background: linear-gradient(135deg, #ffffff 0%, #f0fffd 100%);
  }
  
  .result-label {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 0.5rem;
    font-weight: 500;
  }
  
  .result-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #00D4AA;
  }
  
  .heylight-advantage {
    display: flex;
    align-items: center;
    gap: 1rem;
    background: #ffffff;
    padding: 1.5rem;
    border-radius: 12px;
    border: 2px solid #00D4AA;
    margin-bottom: 2rem;
  }
  
  .advantage-icon {
    font-size: 2rem;
  }
  
  .advantage-text h5 {
    color: #00D4AA;
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
  }
  
  .advantage-text p {
    color: #666;
    margin: 0;
  }
  
  .calculator-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 2rem;
  }
  
  .btn--secondary {
    background: #6c757d;
    color: #ffffff;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .btn--secondary:hover {
    background: #5a6268;
    transform: translateY(-1px);
  }
  
  @media (max-width: 768px) {
    .calculator-form-container {
      padding: 2rem;
    }
    
    .form-row {
      flex-direction: column;
      gap: 1rem;
    }
    
    .results-grid {
      grid-template-columns: 1fr;
    }
    
    .calculator-actions {
      flex-direction: column;
      align-items: center;
    }
  }
</style>

<script>
  function calculateHeylightFinancing(sectionId) {
    const bikePrice = parseFloat(document.getElementById('bike-price-' + sectionId).value);
    const downPayment = parseFloat(document.getElementById('down-payment-' + sectionId).value);
    const loanTerm = parseInt(document.getElementById('loan-term-' + sectionId).value);
    
    if (!bikePrice || !downPayment || !loanTerm) {
      alert('Please fill in all fields to calculate financing.');
      return;
    }
    
    if (downPayment >= bikePrice) {
      alert('Down payment cannot be greater than or equal to bike price.');
      return;
    }
    
    // Calculate loan amount
    const loanAmount = bikePrice - downPayment;
    
    // With Heylight 0% financing, monthly payment is simply loan amount / term
    const monthlyPayment = loanAmount / loanTerm;
    
    // No interest with Heylight
    const totalInterest = 0;
    
    // Total cost is just the loan amount (no interest)
    const totalCost = loanAmount;
    
    // Update results
    document.getElementById('loan-amount-' + sectionId).textContent = 'CHF ' + loanAmount.toFixed(2);
    document.getElementById('monthly-payment-' + sectionId).textContent = 'CHF ' + monthlyPayment.toFixed(2);
    document.getElementById('interest-rate-' + sectionId).textContent = '0%';
    document.getElementById('total-cost-' + sectionId).textContent = 'CHF ' + totalCost.toFixed(2);
    
    // Show results
    document.getElementById('financing-results-' + sectionId).style.display = 'block';
    
    // Scroll to results
    document.getElementById('financing-results-' + sectionId).scrollIntoView({ behavior: 'smooth' });
  }
  
  function resetCalculator(sectionId) {
    document.getElementById('bike-price-' + sectionId).value = '2499';
    document.getElementById('down-payment-' + sectionId).value = '500';
    document.getElementById('loan-term-' + sectionId).value = '24';
    document.getElementById('credit-score-' + sectionId).value = 'good';
    
    document.getElementById('financing-results-' + sectionId).style.display = 'none';
  }
  
  function applyHeylightFinancing(sectionId) {
    alert('Thank you for choosing Heylight! A financing specialist will contact you within 24 hours to complete your application.');
  }
</script>

{% schema %}
{
  "name": "Heylight Calculator",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Calculator Title",
      "default": "Calculate Your Monthly Payment"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Calculator Subtitle",
      "default": "Use our calculator to see exactly what you'll pay each month with Heylight financing"
    },
    {
      "type": "text",
      "id": "calculate_button_text",
      "label": "Calculate Button Text",
      "default": "Calculate with Heylight"
    },
    {
      "type": "text",
      "id": "results_title",
      "label": "Results Title",
      "default": "Your Heylight Financing Summary"
    },
    {
      "type": "text",
      "id": "advantage_title",
      "label": "Advantage Title",
      "default": "You Save CHF 0 in Interest!"
    },
    {
      "type": "textarea",
      "id": "advantage_text",
      "label": "Advantage Text",
      "default": "With Heylight's 0% financing, you pay exactly the bike price - no more, no less."
    },
    {
      "type": "text",
      "id": "reset_button_text",
      "label": "Reset Button Text",
      "default": "Reset"
    },
    {
      "type": "text",
      "id": "apply_button_text",
      "label": "Apply Button Text",
      "default": "Apply with Heylight"
    }
  ],
  "presets": [
    {
      "name": "Heylight Calculator"
    }
  ]
}
{% endschema %}
