<!-- /sections/heylight-calculator.liquid -->
{% comment %}
  Heylight Financing Calculator Section - Add this to any page using the page builder
{% endcomment %}

<section class="section-spacing">
  <div class="page-width">
    <header class="section-header text-center">
      <h2 class="section-header__title">{{ section.settings.title | default: "Calculate Your Monthly Payment" }}</h2>
      <p>{{ section.settings.subtitle | default: "Use our calculator to see exactly what you'll pay each month with Heylight financing" }}</p>
    </header>
    
    <div class="feature-card">
      <div class="grid">
        <div class="grid__item large--one-half medium--one-half">
          <div class="form-field">
            <label for="bike-price-{{ section.id }}">E-Bike Price (CHF)</label>
            <input type="number" id="bike-price-{{ section.id }}" name="bike-price" placeholder="2499" min="500" max="10000" value="2499" class="input-full">
          </div>
        </div>
        
        <div class="grid__item large--one-half medium--one-half">
          <div class="form-field">
            <label for="down-payment-{{ section.id }}">Down Payment (CHF)</label>
            <input type="number" id="down-payment-{{ section.id }}" name="down-payment" placeholder="500" min="0" max="5000" value="500" class="input-full">
          </div>
        </div>
      </div>
      
      <div class="grid">
        <div class="grid__item large--one-half medium--one-half">
          <div class="form-field">
            <label for="loan-term-{{ section.id }}">Loan Term</label>
            <select id="loan-term-{{ section.id }}" name="loan-term" class="input-full">
              <option value="12">12 months</option>
              <option value="24" selected>24 months</option>
              <option value="36">36 months</option>
              <option value="48">48 months</option>
            </select>
          </div>
        </div>
        
        <div class="grid__item large--one-half medium--one-half">
          <div class="form-field">
            <label for="credit-score-{{ section.id }}">Credit Score Range</label>
            <select id="credit-score-{{ section.id }}" name="credit-score" class="input-full">
              <option value="excellent">Excellent (750+)</option>
              <option value="good" selected>Good (700-749)</option>
              <option value="fair">Fair (650-699)</option>
              <option value="poor">Poor (600-649)</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="text-center">
        <button type="button" class="btn btn--large" onclick="calculateHeylightFinancing('{{ section.id }}')">
          {{ section.settings.calculate_button_text | default: "Calculate with Heylight" }}
        </button>
      </div>
    </div>
      
    <div id="financing-results-{{ section.id }}" class="feature-card" style="display: none; margin-top: 2rem;">
      <div class="text-center">
        <span style="font-size: 2rem;">ðŸ’š</span>
        <h3>{{ section.settings.results_title | default: "Your Heylight Financing Summary" }}</h3>
      </div>
      
      <div class="grid grid-uniform">
        <div class="grid__item large--one-quarter medium--one-half">
          <div class="text-center">
            <p><strong>Loan Amount</strong></p>
            <p class="h4" id="loan-amount-{{ section.id }}">CHF 1,999</p>
          </div>
        </div>
        
        <div class="grid__item large--one-quarter medium--one-half">
          <div class="text-center">
            <p><strong>Monthly Payment</strong></p>
            <p class="h4" id="monthly-payment-{{ section.id }}">CHF 83.29</p>
          </div>
        </div>
        
        <div class="grid__item large--one-quarter medium--one-half">
          <div class="text-center">
            <p><strong>Interest Rate</strong></p>
            <p class="h4" id="interest-rate-{{ section.id }}">0%</p>
          </div>
        </div>
        
        <div class="grid__item large--one-quarter medium--one-half">
          <div class="text-center">
            <p><strong>Total Cost</strong></p>
            <p class="h4" id="total-cost-{{ section.id }}">CHF 1,999</p>
          </div>
        </div>
      </div>
      
      <div class="text-center" style="margin-top: 2rem; padding: 1rem; border: 1px solid {{ settings.colorBorder }};">
        <span style="font-size: 2rem;">ðŸŽ‰</span>
        <h4>{{ section.settings.advantage_title | default: "You Save CHF 0 in Interest!" }}</h4>
        <p>{{ section.settings.advantage_text | default: "With Heylight's 0% financing, you pay exactly the bike price - no more, no less." }}</p>
      </div>
      
      <div class="text-center" style="margin-top: 2rem;">
        <button class="btn" onclick="resetCalculator('{{ section.id }}')">
          {{ section.settings.reset_button_text | default: "Reset" }}
        </button>
        <button class="btn btn--large" onclick="applyHeylightFinancing('{{ section.id }}')" style="margin-left: 1rem;">
          {{ section.settings.apply_button_text | default: "Apply with Heylight" }}
        </button>
      </div>
    </div>
  </div>
</section>


<script>
  function calculateHeylightFinancing(sectionId) {
    const bikePrice = parseFloat(document.getElementById('bike-price-' + sectionId).value);
    const downPayment = parseFloat(document.getElementById('down-payment-' + sectionId).value);
    const loanTerm = parseInt(document.getElementById('loan-term-' + sectionId).value);
    
    if (!bikePrice || !downPayment || !loanTerm) {
      alert('Please fill in all fields to calculate financing.');
      return;
    }
    
    if (downPayment >= bikePrice) {
      alert('Down payment cannot be greater than or equal to bike price.');
      return;
    }
    
    // Calculate loan amount
    const loanAmount = bikePrice - downPayment;
    
    // With Heylight 0% financing, monthly payment is simply loan amount / term
    const monthlyPayment = loanAmount / loanTerm;
    
    // No interest with Heylight
    const totalInterest = 0;
    
    // Total cost is just the loan amount (no interest)
    const totalCost = loanAmount;
    
    // Update results
    document.getElementById('loan-amount-' + sectionId).textContent = 'CHF ' + loanAmount.toFixed(2);
    document.getElementById('monthly-payment-' + sectionId).textContent = 'CHF ' + monthlyPayment.toFixed(2);
    document.getElementById('interest-rate-' + sectionId).textContent = '0%';
    document.getElementById('total-cost-' + sectionId).textContent = 'CHF ' + totalCost.toFixed(2);
    
    // Show results
    document.getElementById('financing-results-' + sectionId).style.display = 'block';
    
    // Scroll to results
    document.getElementById('financing-results-' + sectionId).scrollIntoView({ behavior: 'smooth' });
  }
  
  function resetCalculator(sectionId) {
    document.getElementById('bike-price-' + sectionId).value = '2499';
    document.getElementById('down-payment-' + sectionId).value = '500';
    document.getElementById('loan-term-' + sectionId).value = '24';
    document.getElementById('credit-score-' + sectionId).value = 'good';
    
    document.getElementById('financing-results-' + sectionId).style.display = 'none';
  }
  
  function applyHeylightFinancing(sectionId) {
    alert('Thank you for choosing Heylight! A financing specialist will contact you within 24 hours to complete your application.');
  }
</script>

{% schema %}
{
  "name": "Heylight Calculator",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Calculator Title",
      "default": "Calculate Your Monthly Payment"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Calculator Subtitle",
      "default": "Use our calculator to see exactly what you'll pay each month with Heylight financing"
    },
    {
      "type": "text",
      "id": "calculate_button_text",
      "label": "Calculate Button Text",
      "default": "Calculate with Heylight"
    },
    {
      "type": "text",
      "id": "results_title",
      "label": "Results Title",
      "default": "Your Heylight Financing Summary"
    },
    {
      "type": "text",
      "id": "advantage_title",
      "label": "Advantage Title",
      "default": "You Save CHF 0 in Interest!"
    },
    {
      "type": "textarea",
      "id": "advantage_text",
      "label": "Advantage Text",
      "default": "With Heylight's 0% financing, you pay exactly the bike price - no more, no less."
    },
    {
      "type": "text",
      "id": "reset_button_text",
      "label": "Reset Button Text",
      "default": "Reset"
    },
    {
      "type": "text",
      "id": "apply_button_text",
      "label": "Apply Button Text",
      "default": "Apply with Heylight"
    }
  ],
  "presets": [
    {
      "name": "Heylight Calculator"
    }
  ]
}
{% endschema %}
